\documentclass[lotsofwhite,charterfonts]{patmorin}
\usepackage{amsthm,amsfonts,graphicx}
\input{pat}

\newcommand{\rep}[1]{^{\langle#1\rangle}}

\newcommand{\toomuchdetail}[1]{#1}
\newcommand{\degreesum}{Condition~(a)}
\newcommand{\maxdegree}{Condition~(b)}
\newcommand{\twotwos}{Condition~(c)}
\newcommand{\onebig}{Condition~(d)}
\newcommand{\fourds}{Condition~(e)}
\newcommand{\degree}{\mathrm{deg}}

\title{\MakeUppercase{Degree Sequences of 2-Trees}%
	\thanks{This research was partly funded by NSERC.}}

\author{
	Greg Aloupis \and
	Prosenjit Bose \and
	David Bremner \and
	Mirela Damian-Lordache \and
	Erik Demaine \and 
	Martin Demaine \and
	Dania El-Khechen \and
	Vida Dujmovi\'{c} \and
	Robin Flatland \and
	Francisco Gomez-Martin \and
	John Iacono \and
	Danny Kri\c{z}anc \and
	Stefan Langerman \and
	Erin Leigh McLeish \and
	Henk Meijer \and
	Pat Morin \and
	Sumeeta Ramaswami \and
	David Rappaport \and
	Diane Souvaine \and
	Perouz Taslakian \and
	Godfried Toussaint \and
	Dmitri Tymoczko \and
	David Wood \and
	Stefanie Wuhrer \and
}

\date{}

\begin{document}
\maketitle
\begin{abstract}
A characterization of the degree sequences of 2-trees is
given.  This characterization yields a linear-time algorithm for
recognizing and realizing degree sequences of 2-trees.
\end{abstract}

\section{Introduction}

The \emph{degree sequence} of a graph $G=(V,E)$ is the sequence
obtained by listing the degrees of the vertices of $G$ in
non-decreasing order.  If $D=\langle d_1,\ldots,d_n\rangle$ is the
degree sequence of $G$ then we say that $G$ is a \emph{realization} of
$D$ or that $G$ \emph{realizes} $D$.  

In this paper we consider degree sequences of a particular class of
graphs.  \emph{2-trees} are defined inductively as follows:  The
complete graph $K_3$ on 3 vertices is a 2-tree and any 2-tree $T$ on
$n$ vertices can be obtained from some 2-tree $T'$ on $n-1$ vertices
by adding a new vertex $u$ adjacent to two vertices $v$ and $w$ that
are adjacent in $T'$.  We call this process \emph{attaching} the
vertex $u$ to the edge $\{v,w\}$.

It is helpful to have a notation for elements of a sequence that occur
often.  We denote by $a\rep{b}$ the (sub)sequence $a,a,\ldots,a$ of
length $b$. We prove the following result:

\begin{thm}\thmlabel{main}
The following two statements are equivalent:
\begin{enumerate}
\item $D=\langle d_1,\ldots,d_n\rangle$ is a non-decreasing sequence of
      natural numbers such that
\begin{enumerate}
\item $\sum_{i=1}^n d_i = 4n-6$,
\item $\max\{d_i : 1\le i\le n\} \le n-1$,
\item $d_1=d_2=2$,
\item $D\not\in \{ 2\rep{p},4\rep{n-p-1}, 2p-2 : n > 3p-3 \}$, and 
\item $D\not\in \{\langle 2\rep{n-4},d,d,d,d\rangle : d\ge 5\}$.
\end{enumerate}
\item $D$ is the degree sequence of a 2-tree.  
\end{enumerate}
Furthermore, for each $D=\langle d_1,\ldots,d_n\rangle$ satisfying
Conditions~(a)--(e) and a given $d_i \ge 3$ there exists a 2-tree that
realizes $D$ in which a vertex of degree $d_i$ is adjacent to a vertex
of degree $2$.  
\end{thm}

We denote by $\mathcal{D}$ the set of all degree sequences satisfying
Conditions~(a)--(e) of \thmref{main}.  The remainder of this paper is
organized as follows:  In \secref{if} we show that the every sequence
$D\in \mathcal{D}$ is the degree sequence of a 2-tree.  In
\secref{onlyif} we show that the degree sequence of every 2-tree is
in $\mathcal{D}$.

\section{The Elements of $\mathcal{D}$ are the Degree Sequences of
	2-Trees}\seclabel{if}

In this section we prove that if $D\in \mathcal{D}$ then $D$ is the
degree sequence of a 2-tree.  Our proof is by induction on $n$, the
length of the sequence.  However, during the process of applying
induction we come across several different base cases.

\subsection{The Base Cases}

\begin{lem}\lemlabel{basecase-a}
The sequence $\langle 2,2,2\rangle$ is the degree sequences of a 2-tree.
\end{lem}

\begin{proof}
This follows immmediately from the definition of 2-trees.
\end{proof}


\begin{lem}\lemlabel{basecase-b}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{n-2},x,y\rangle:
x,y\ge 3\}$. 
Then there exists a 2-tree that realizes $D$ in which every vertex of
degree greater than $2$ is adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
From \degreesum\ we know that $2(n-2)+x+y=4n-6$ or, equivalently,
$x+y=2n-2$.  By \maxdegree\ this implies that $x=y=n-1$.  Thus,
we can create a 2-tree realizing $D$ by starting with a $K_3$ and
attaching $n-3$ vertices to one of its edges.
\end{proof}

\begin{lem}\lemlabel{basecase-c}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{n-3},x,y,z\rangle:
x,y,z\ge 3\}$. 
Then there exists a 2-tree that realizes $D$ in which every vertex of
degree greater than $2$ is adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
We create a 2-tree by starting with the graph $K_3$ (which, according
to \lemref{basecase-a}, is a
2-tree) and attaching the following numbers of vertices to its edges:
\[
    e_1=\frac{1}{2}(x+y-z-2) \enspace , \enspace
    e_2=\frac{1}{2}(x-y+z-2) \enspace , \enspace 
    e_3=\frac{1}{2}(-x+y+z-2) \enspace .
\]
It is straightforward to verify that the resulting 2-tree has three
vertices of degree $x$, $y$, and $z$, respectively, and that all other
vertices have degree 2.  All that remains to verify that is that
$e_1$, $e_2$ and $e_3$ are non-negative integers.  These number are
certainly integers because, by \degreesum, $x+y+z$ is even.  

Next we show that $e_1$ is non-negative.  Observe that, by \degreesum,
$2(n-3)+x+y+z = 4n-6$ or, equivalently, $x+y+z=2n$.  By \maxdegree,
this implies that $x+y \ge n+1$ and that $x+y-z \ge 2$.  Thus,
$x+y-z-2 \ge 0$ and $e_1$ is non-negative, as required.  
Exactly the same argument shows that $e_2$ and $e_3$ are also
non-negative.
\end{proof}

\begin{lem}\lemlabel{basecase-d}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{n-5},d,d,d,x,d+x-2 \rangle:
\mbox{$d,x\ge 3$}\}$.
Then there exists a 2-tree that realizes $D$ and such that, for every
$d\in D$ there exists a vertex of degree $d$ adjacent to a vertex of
degree 2.
\end{lem}

\begin{proof}
Begin with the 5 vertex fan depicted in \figref{basecase-d-a} that has
one vertex $v_1$ of degree 4, two vertices $v_2$ and $v_5$ of degree 2
and two vertices $v_2$ and $v_3$ of degree 3.  There are two cases to
consider:

\noindent\textbf{Case 1:} $d\ge 4$.  In this case, attach 1 vertex
each to $\{v_2,v_3\}$ and $\{v_4,v_5\}$, attach $d-4$ vertices to
$\{v_3,v_4\}$, attach $x-3$ vertices to $\{v_1,v_2\}$ and attach
$\{d-3\}$ vertices to $\{v_1,v_5\}$ (\figref{basecase-d-b}).  Then
$\degree(v_1)=d+x-2$, $\degree(v_2)=x$,
$\degree(v_3)=\degree(v_4)=\degree(v_5)=d$, and all other vertices
have degree 2, as required.

\noindent\textbf{Case 2:} $d=3$.  In this case, attach $x-3$ vertices
to $\{v_1,v_2\}$.  Let one of these newly attached vertices be called
$v_6$ and attach another vertex to $\{v_1,v_6\}$
(\figref{basecase-d-c}).  Then $\degree(v_1)=x+2=d+x-2$,
$\degree(v_2)=x$, $\degree(v_6)=\degree(v_3)=\degree(v_4)=3$, and and
all other vertices have degree 2, as required. 
\end{proof}


\begin{lem}\lemlabel{basecase-e}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{p},d\rep{n-p}\rangle:
\mbox{$d\ge 3$ and $n-p \ge 5$}\}$.
Then there exists a 2-tree that realizes $D$ and such that, for every
$x\in D$ there exists a vertex
of degree $x$ adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
Let $q=n-p$. Having $q$ at least $5$ implies that $d\not=3$, otherwise
$D\not\in \mathcal{D}$, by Condition (a) of \thmref{main}. Suppose
$d=4$. In that case, Condition (a) of \thmref{main} implies that
$p=3$, giving rise to the sequence $D=\{\langle
2\rep{3},4\rep{n-3}\rangle$ with $n\geq 7$ (since $q\geq 5$). This
sequence is excluded from $\mathcal{D}$, by Condition (d) of
\thmref{main}. Therefore we may assume that $d\geq 5$.

Let $D$ denote a sequence with $q\geq 5$ degrees $d$, $d\geq 5$,
satisfying the conditions of the lemma. We prove the lemma by
constructing a 2-tree $G$ that realizes $D$. In what follows we will
only make sure that $G$ has the correct number, $q$, of degree-$d$,
vertices. The fact that vertex degrees of all 2-trees add up to $4n-6$
will ensure that the number of degree-2 vertices matches that of $D$.

Suppose we know the following claim to be correct (which will be proved later).

\begin{clm} Let $D'\in \mathcal{D}\cap \{\langle 2\rep{p'},4, d\rep{n-p'-1}\rangle:\mbox{$d\ge 5$ and $q'=n-p'-1 \ge 2$}\}$.
Then there exists a 2-tree that realizes $D'$ in which the degree-4 vertex is adjacent to a degree-2 vertex.
\end{clm}

Consider a 2-tree $G'$ that realizes a sequence $D'$ from the above
claim. Let edge $vw$ be the edge of $G'$ such that $v$ is degree-2 and
$w$ is degree-4 vertex in $G'$. Attach $d-4>0$ vertices to edge $vw$
and call one of them $x$. Proceed by attaching one vertex, $y$, to
edge $vx$, followed by attaching one vertex to edge $vy$ and $d-2>0$
vertices to edge $yx$. (This construction is illustrated in
\figref{1}). The resulting graph $G$, is a 2-tree where the degree of
each vertex is either $d$ or $2$ and there is an edge between a
degree-$2$ and degree-$d$ vertex  (consider for example any one of
$v$, $x$, or $y$). Since $v$, $w$, $x$ and $y$ have degree $d$ in $G$,
$G$ has $q'+4$ vertices of degree $d$, and realizes a sequence $D$
provided that $q\geq 6$.

For the remaining case, the sequences $D$ with $q=5$, we give explicit
realization for $D$. Start with a $2$-tree as in \figref{2.1}. Attach
$\frac{d-4}{2}$ vertices to edge $ab$ and as many to edge $ae$. Note
that $d$ has to be even, since $q$ is odd, and thus $d\geq 6$. Attach
$\frac{d-6}{2}\geq 0$ vertices to edge $cd$, and $\frac{d}{2}>0$
vertices to each of the edges $bc$ and $de$. The resulting $2$-tree
$G$ has $q=5$ vertices of degree $d$ and each degree-$d$ vertex is
adjacent to at least one degree-$2$ vertex. Thus $G$ is a desired
realization of $D$.

To complete the proof we need to demonstrate that the above claim is
correct. Let $D'$ be the sequence from the claim with $q'\geq 2$
vertices of degree $d$. The proof is by induction on $q'$. The (even)
base case, $q'=2$, follows from \lemref{basecase-c}, with $x=4$, $y=d$
and $z=d$. For the (odd) base case, $q'=3$, we start with the 2-tree
from  \lemref{basecase-c} with $x=d-2>0$, $y=d$ and $z=d$ with an edge
between degree-($d-2$) vertex $v$ and some degree-2 vertex $w$ and
simply attached two vertices to edge $vw$ to obtain the realization
$G'$ for $D$ with an edge between degree-2 and degree-4 vertex in
$G'$.

For the general case, that is, sequences $D'$ with $q'\geq 4$, we
start with a 2-tree $G^-$ that realizes the sequence with $q'-2$
vertices of degree $d$. Such graph $G^-$ exists by induction
hypothesis and moreover there is an edge between a degree-2 vertex $v$
and the degree-4 vertex $w$ in $G^-$. To obtain realization for $D'$
we attach $d-4>0$ vertices to edge $vw$, call one of them $x$. Attach
two more vertices to edge $vx$, as illustrated in \figref{3}. In the
resulting 2-tree $G'$, the degree of $v$ and $w$ is $d$, the degree of
$x$ is $4$ and $x$ is adjacent to a degree-2 vertex. Thus $G'$ has
$g'$ vertices of degree $d$, one degree-4 vertex and an edge between
the degree-4 and degree-2 vertex, and is thus a desired realization of
$D'$.  
\end{proof}

\begin{lem}\lemlabel{basecase-f}
Suppose $D\in \mathcal{D}$ contains the value $n-1$. Let $x \geq 3$ be
an arbitrary value in $D$.  Then there exists a 2-tree that realizes
$D$ in which a vertex of degree $x$ is adjacent to a vertex of degree
$2$.
\end{lem}

\begin{proof} 
The proof of this Lemma proceeds by constructing a realization of $D$
as a 2-tree, where a vertex of degree $x$ is adjacent to a vertex of
degree $2$.

In a first step, we alter the sequence $D$ by removing the value $n-1$
and by reducing every remaining value by one. The degree sequence
$D^{(1)} = \langle d_1^{(1)},\ldots,d_{n_1}^{(1)}\rangle$ we obtain
contains $n_1 = n-1$ values. Since $D$ contains the value $x$,
$D^{(1)}$ contains the value $x-1$. Since $D\in \mathcal{D}$,
$d_1^{(1)} = d_2^{(1)} = 1$ and $\sum_{i=1}^{n_1} = 4n-6 - 2(n-1) =
2(n-1) - 2 = 2n_1 - 2$. It is well-known that any degree sequence of
positive integers of length $k$ with $\sum_{i=1}^{k} = 2k - 2$ is the
degree sequence of a tree. Hence, there exists a tree with degree
sequence $D^{(1)}$.

If $x = n-1$, we find a tree with degree sequence $D^{(1)}$. Adding a
vertex adjacent to every vertex of that tree yields a 2-tree that
realizes $D$. The last vertex we add is of degree $x = n-1$ and
adjacent to every other vertex. Since there are at least two vertices
of degree $2$, there exists a vertex of degree $x$ adjacent to a
vertex of degree $2$.

If $x \neq n-1$, we alter the sequence $D^{(1)}$ by removing
$d_1^{(1)}$ and by replacing the value $x-1$ by $x-2$. The sequence
$D^{(2)} = \langle d_1^{(2)},\ldots,d_{n_2}^{(2)}\rangle$ contains
$n_2 = n-2$ values. Furthermore, $\sum_{i=1}^{n_2} = 2n_1 - 4 = 2n_2 -
2$. Hence, there exists a tree with degree sequence $D^{(2)}$. We find
this tree and add a vertex adjacent to a vertex of degree $x-2$. Since
$d_1^{(1)} = 1$, this is a realization of $D^{(1)}$ as a tree, where a
vertex of degree $x-1$ is adjacent to a leaf of the tree. Adding a
vertex adjacent to every vertex of the tree realizing $D^{(1)}$ yields
a 2-tree that realizes $D$. Since the last vertex we add increases the
degree of every vertex by one, there exists a vertex of degree $x$
adjacent to a vertex of degree $2$ in this 2-tree.  \end{proof}

\begin{lem}\lemlabel{basecase-g}
Suppose $D\in \mathcal{D}\cap \{\langle
2\rep{p},4\rep{n-p-2},x,2p-x+2\rangle\}$.  Then there exists a 2-tree
that realizes $D$ in which every vertex of degree greater than $2$ is
adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
Jit's still working on this because I changed the problem on him.
\end{proof}

\subsection{The Induction}

With the base cases out of the way, we are ready for an inductive
proof of the first half of \thmref{main}.

\begin{lem}\lemlabel{if}
If $D=\langle d_1,\ldots,d_n\rangle \in \mathcal{D}$ and $d_i\ge 3$
then there exists a 2-tree that realizes $D$ in which a vertex of
degree $d_i$ is adjacent to a vertex of degree 2.  
\end{lem}

\begin{proof}
We are given $D$ and a particular value $d_i$. If $D$ meets the
conditions of Lemmata~\ref{lem:basecase-a}, \ref{lem:basecase-b},
\ref{lem:basecase-c}, \ref{lem:basecase-d}, \ref{lem:basecase-e}, or
\ref{lem:basecase-g} then we are done.  Otherwise, select a value
$d_j$, $d_j\neq d_i$, $d_j\ge 3$.  We know such a value exists because
neither \lemref{basecase-a}, \lemref{basecase-b}, \lemref{basecase-c},
nor \lemref{basecase-e} is applicable to $D$.  The value $d_j$ is
selected as follows:  Let $a=\min\{d_k : d_k\ge 3\}$ and let $c=d_n$.
If $d_i=a$ or $a+c-2 \ge n$ then we select $d_j=d_n$ otherwise we
select $d_j=a$.  Without loss of generality, assume $d_i < d_j$
(otherwise reverse the roles of $d_i$ and $d_j$) and let $x=d_i$.
Create a new sequence 
\[  
   D'=\langle d_{x-2+1},\ldots,d_{i}-x+2,\ldots,d_{j}-x+2,\ldots,d_n \rangle
\] 
and, if necessary, reorder the elements of $D'$ into non-decreasing
order.  The proof of the following claim is left until later:

\begin{clm}\clmlabel{main}
$D'\in \mathcal{D}$.
\end{clm}

Now, apply the inductive hypothesis on the sequence $D'$ with the
special value $d_j-x+2$ to obtain a 2-tree $T'$ in which a vertex $v$
of degree $d_j-x+2$ is adjacent to a vertex $w$ of degree 2.  Attach
$x-2$ vertices to the edge $\{v,w\}$ to obtain a 2-tree that realizes
$D$ and in which vertices of degree $d_i$ and $d_j$ are each adjacent
to $x-2\ge 1$ vertices of degree $2$.  This completes the proof.
\end{proof}


\begin{proof}[Proof of \clmref{main}]

We must show that $D'$ satisfies Conditions~(a)-(e) of \thmref{main}.
We know that $D$ satisifies Conditions~(a)-(e) and that $D$ does not
satisfy the conditions of any of
Lemmata~\ref{lem:basecase-a}--\ref{lem:basecase-g}.  Let $p$ be the number
of times 2 appears in $D$ and recall that $a=\min\{d_i:d_i > 2\}$ and
$c=d_n=\max\{d_i\in D\}$.  We begin by considering \fourds\ and
\onebig\ since these can be shown independent of the choice of $d_j$.

\noindent\onebig:
If $D'\in\{\langle 2\rep{p'},4\rep{n'-p'-1},
2p'-2\rangle\}$ then 
$D\in\{\langle 2\rep{p},4\rep{n-p-2},x,2p-x+2\rangle:x\ge 3\}$ which
is not possible because then \lemref{basecase-g} would apply to $D$.

\noindent\fourds:
If $D'\in \{\langle 2\rep{n'-4},d,d,d,d\rangle : d\ge 5\}$ then
$D\in\{\langle 2\rep{n'+x-6},d,d,d,x,d+x-2\rangle : d,x\ge 3\}$ which
is not possible since then \lemref{basecase-e} would apply to $D$.


\comment{
If $n'< 2p'-1$ then
\[
      n' = n-x+2 < 2p'-1  
         \toomuchdetail{= 2(p-x+3) - 1}
         = 2p-2x + 5 \enspace , 
\]
so $n < 2p-x+3$ but this is not possible since then $D$ does not 
satisfy
\maxdegree.

On the other hand, if $n'>3p' - 3$ then
\[
      n' = n-x+2 > 3p' - 3 
         \toomuchdetail{= 3(p-x+3) - 3}
         = 3p - 3x + 6
\]
so $n > 3p - 2x + 4$.  So what?
}

Next we show that $D'$ satisfies Conditions~(a)-(c).  There are two
cases to consider, depending on the choice of $d_j$.

\noindent\textbf{Case 1:} $d_i=x=a$ and $a+c-2 \le n-1$.

\noindent\degreesum\ and \twotwos:  To show that these conditions hold for $D'$
it is sufficient to show that $p'=p-a+3 \ge 2$, i.e., that $p\ge a-1$.
Notice that, if $a=3$ then \twotwos\ on $D$ already implies $p\ge 2=
a-1$.  Thus, assume $a\ge 4$.  Then, from \degreesum\ we have
\[
      2p + a + 4(n-p-2) + d_j \le 4n-6 \enspace ,
\]
which simplifies to $p\ge (a+d_j)/2 -1 \ge a-1$, as required.

\noindent\maxdegree: To show that \maxdegree\ holds for $D'$, observe
that $\max\{d:d\in D'\}\le\max\{d:d\in D\}= c$ and the conditions of
Case~2 ensure that $c \le n-a+1= n'-1$.


\noindent\textbf{Case 2:} $d_j=d_n=c$ and $a+c-2\ge n$.  

First we dispense with the case $a=3$.  In this case the condition
$a+c-2\ge n$ implies $c\ge n-1$.  But this is not possible because
then \maxdegree\ implies that $c=n-1$ in which case
\lemref{basecase-f} applies to $D$.  Thus we will assume for the
remainder of the proof that $a\ge 4$.

\noindent\degreesum\ and \twotwos:  To show that these conditions hold
for $D'$, it suffices to show that $p'=p-x+3\ge 2$, i.e., that $p\ge
x-1$.  Since $a\ge 4$ and $D$ satisified
\degreesum, we have 
\[
             2p+4(n-p-2)+x+c \le 4n-6 \enspace ,
\]
which simplifies to $p\ge (x+c)/2-1\ge x-1$, as required.

\noindent\maxdegree:  Let $b=\max\{d:d\in D'\}$.  The sequence $D'$
has length $n'=n-x+2$ and we must show that $b\le n'-1$.  If
$b=d_n-x+2$ then the assumption that $D$ satisifies \maxdegree\
implies $b\le n'-1$.  Thus, assume $b\neq d_{n}-x+2$ so that the values
$x$, $b$ and $c$ each occur in $D$, i.e., $d_i=x$, $d_j=c$ and $d_k=b$
with $i$, $j$ and $k$ distinct.

Let $t=n-p-3$.  Then, from \degreesum\ on $D$ we have
\[
     2p + ta + x + b + c  \le 4n-6 \enspace , 
\]
which, since $n=p+t+3$, is equivalent to 
\[
     t(a-2) + x + b + c  \le 2n \enspace .
\]
Adding $1-x-n$ to both sides gives
\[
     t(a-2) + b + c - n + 1\le n - x + 1 = n' - 1\enspace .
\]
Since $a+c-n \ge 2$, $t\ge 0$ and $a\ge 3$ we have
\begin{eqnarray*}
     n'-1 & \ge & t(a-2) + b + c - n + 1 \\
          & \ge & t(a-3) + b + 3 \\
          & \ge & b+3 \ge b
\end{eqnarray*}
as required.

We have verified that, in both cases $D'$ satisfies
Conditions~(a)--(e) of \thmref{main}, thus completing the proof.
\end{proof}


\section{Degree Sequences of 2-Trees are in $\mathcal{D}$}\seclabel{onlyif}

\begin{lem}\lemlabel{onlyif-a}
Any sequence $D$ that does not satisfy Conditions~(a)-(c) of
\thmref{main} is not the degree sequence of any 2-tree.
\end{lem}

\begin{proof}
It is easy to verify that every 2-tree has $2n-3$ edges and hence
its degree sequence satisfies Condition~(a).
Every simple graph (and hence every 2-tree) satisfied Condition~(b).
Finally, Condition~(c) follows from the 
well-known fact that every two tree has at least 2 vertices of degree
2 \cite{X}.
\end{proof}

\begin{lem}\lemlabel{onlyif-b}
Any sequence $D\in\{\langle 2\rep{n-4},d,d,d,d\rangle : d\ge 5\}$ is not 
the degree sequence of any 2-tree.
\end{lem}

\begin{proof}
Suppose, by way of contradiction, that $T$ is a 2-tree that realizes
$D\in\{\langle 2\rep{n-4},d,d,d,d\rangle : d\ge 5\}$.  Then the degree
$d$ vertices in $T$ form the subgraph shown in \figref{onlyif-b}
(why?).  This graph has five edges $e_1,\ldots,e_5$.  Let $x_i$ be
the number of degree 2 vertices attached to $e_i$, for $1\le i\le 5$.
Then we must have
\[
   2d = x_1 + x_3 + x_2 + x_4 + 4
\]
and 
\[
   2d = x_2 + x_2 + x_3 + x_4 + x_5 + 5
\]
which is not possible since the $x_i$ must all be non-negative.
\end{proof}


\begin{lem}\lemlabel{onlyif-c}
Any sequence $D\in\{2\rep{p},4\rep{n-p-1}, 2p-2 : \mbox{$n < 2p-1$ or
$n > 3p-3$} \}$ is not the degree sequence of any 2-tree.
\end{lem}

\begin{proof}
Suppose, by way of contradiction, that $T$ is a 2-tree that realizes
$D\in\{2\rep{p},4\rep{n-p-1}, 2p-2 : n > 3p-3 \}$.

Consider the subgraph $T'$ of $T$ induced by the degree 4 vertices.
It has the following properties:
\begin{enumerate}
\item Every vertex in $T'$ is adjacent to the vertex of degree $2p-2$.
\item $T'$ is a tree
\end{enumerate}

Let $n_1$, $n_2$ and $n_3$ be the number of leaves, respectively, degree 2
vertices and degree 3 vertices, in $T'$.  Then because $T'$ is a
binary tree we have 
\begin{equation}
   n_1=n_3+2 \enspace . \eqlabel{leaves} 
\end{equation}
Every degree 1, respectively, degree 2, vertex in $T'$ is adjacent to
2, respectively, 1, degree 2 vertex in $T$ so
\begin{equation}
   2n_1 + n_2 \le 2p  \enspace . \eqlabel{charging}
\end{equation} 
Subtracting \eqref{leaves} from \eqref{charging} gives
\[
    n_1 + n_2 + n_3 \le 2p-2
\]
and using the identity 
\begin{equation}
     n_1+n_2+n_3 = n-p-1 \eqlabel{size}
\end{equation}
gives
\[
     n \le 3p-1 \enspace 
\]\marginpar{not $n\le 3p-2$!}
On the other hand, the number of leaves in a
binary tree exceeds the number of internal nodes by at most two, so 
\[
      n_1 \le n_2 + n_3 + 2 \enspace .
\]
Adding $n_1$ to both sides and using the identity \eqref{size}
gives
\[
     2n_1 \le n-p+1 \enspace .
\]
Finally, each leaf in $T'$ is adjacent to two degree 2 vertices, so
$p\le 2n_1$, so
\[
     2p \le n \enspace .
\]
We have just shown that $n\ge 2p$ and $n\le 3p-1$, contradicting the
choice of $D$.
\end{proof}

\begin{lem}\lemlabel{onlyif}
Any sequence $D\not\in \mathcal{D}$ is the not the degree sequence of
any 2-tree.
\end{lem}

\begin{proof}
This follows immediately from \lemref{onlyif-a}, \lemref{onlyif-b} and
\lemref{onlyif-c}.
\end{proof}

\section{Conclusions}

Together, \lemref{if} and \lemref{onlyif} prove both directions of
\thmref{main}.

\begin{itemize}
\item Sketch $O(n)$ time realization algorithm.
\item Mention open problems.
\end{itemize}

\section{Acknowledgements}

This research was initiated at the The 21st Bellairs Winter Workshop
on Computational Geometry, January 27--February 3, 2006.  The authors
are grateful to Godfried~Toussaint for organizing the workshop and to
the other workshop participants, namely
---,
---,
---, and
---,
for providing a stimulating working environment.


\bibliographystyle{plain}
\bibliography{paper}
\end{document}

