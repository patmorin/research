\documentclass[lotsofwhite]{patmorin}
\usepackage{amsthm}

\newcommand{\CH}{\mathit{CH}}
\newcommand{\Z}{\mathit{Z}}
\newcommand{\DZ}{\mathit{DZ}}
\newcommand{\depth}{\mathrm{depth}}
\newcommand{\argmax}{\mathrm{argmax}}
\newcommand{\drop}{\!\!\downarrow\!\!}

\input{pat}

%\title{An Optimal Algorithm for $d$-Variate Zonoid Depth}
\title{\MakeUppercase{An Optimal Algorithm
	for} $d$\MakeUppercase{-Variate Zonoid Depth}}
\author{Pat Morin}
\date{}

\begin{document}
\maketitle
\begin{abstract}
Algorithms for Zonoid depth in $d$ dimensions are considered.
\end{abstract}

\section{Introduction}

Let $S=\{p_1,\ldots,p_n\}$ be a set of $n$ points in $\mathbb{R}^d$.
For a real number $k\ge 1$, the \emph{$k$-zonoid} of $S$ is defined as 
\[
      \Z_k(S) = \left\{\sum_{i=1}^n \lambda_ip_i 
	: \mbox{$0\le \lambda_i\le 1/k$ 
	   and $\sum_{i=1}^n\lambda_i = 1$}  \right\} \enspace .
\] 
Notice that, for $k=1$ the $1$-zonoid of $S$ is the convex hull of
$S$,  i.e., $\Z_1(S)=\CH(S)$.
As $k$ increases, $\Z_k(S)$ becomes smaller and smaller until
the limiting case $k=n$, for which $\Z_k(S)$ consists of a single point,
the mean of $S$.  The \emph{zonoid depth} of a point
$p\in\CH(S)$ with respect to $S$ is defined as
\[
     \depth(p,S) = \sup\{k : p\in Z_k(S) \} \enspace ,
\]
and is a real number in the interval $[1,n]$.

Gopala and Morin \cite{gm06} consider algorithms for bivariate ($d=2$)
zonoid depth and give $O(n)$ time algorithms for computing, for a
point $p\in \mathbb{R}^2$, the zonoid depth of $p$ with respect to
$S$.  The current paper extends their results by giving an algorithm
to compute the zonoid depth of any point $p\in\CH(S)$ in $O(n)$ time,
for any constant dimension $d$.

\section{Chan's Generalized Optimization Technique}

Chan \cite{c2004} used the following theorem to provide an $O(n\log
n)$ time algorithm for maximum Tukey depth.

\begin{thm}[Chan 2004]\thmlabel{chan}
Let $\mathcal{H}$ denote the set of all halfspaces in $\mathbb{R}^d$,
let $\mathcal{P}$ denote the set of all possible inputs to some problem, 
let $f:\mathcal{P}\rightarrow 2^{\mathcal{H}}$ be any function mapping 
problem inputs to sets of halfspaces in $\mathbb{R}^d$,
and let $w:\mathbb{R}^d\rightarrow \mathbb{R}$ be
any linear objective function.  Suppose that $f$ satisfies:
\begin{enumerate}

\item Given inputs $P_1,\ldots,P_d\in\mathcal{P}$ each of constant
size, the point $p\in\bigcap_{i=1}^d f(P_i)$ maximizing $w(p)$ can be
found in constant time.

\item Given a point $p\in\mathbb{R}^d$ and an input $P$ of size $n$,
there exists a $D(n)$ time algorithm to determine whether
$p\in\bigcap_{h\in f(P)} h$.

\item Given an input $P\in\mathcal{P}$ of size $n$, there exists a $D(n)$ time
algorithm that computes inputs $P_1,\ldots,P_r$ each of size at most
$\alpha n$ such that 
$f(P) = \bigcup_{i=1}^r f(P_i)$.
\end{enumerate}
Then there exists an $O(D(n))$ expected time randomized algorithm to
compute, for any input $P\in\mathcal{P}$ of size $n$ the point
$p\in\mathbb{R}^d$ that maximizes $w(p)$.
\end{thm}

It is worth noting the function $f$ that the codomain of the function
$f$ may contain infinite sets.  That is, it is acceptable (and common)
to have inputs $P\in\mathcal{P}$ such that $|f(P)|=\infty$.


\section{Dual Zonoids}

The $k$-zonoid $Z_k(S)$ is a convex polytope.  The extreme-most vertex
of $Z_k(S)$ in direction $w$ can be obtained as follows:  Denote by
$p_1^w,\ldots,p_n^w$ the points of $S$ ordered by their projection
onto a line in direction $w$.  That is, $p_i\cdot w \ge p_{i+1}\cdot
w$ for all $1\le i\le n-1$.  Then the extreme-most vertex of $Z_k(S)$
in direction $w$ is given by 
\[  
   \argmax\{p\cdot w: p\in Z_k(S)\} =
\left(\frac{1}{k}\sum_{i=1}^{\floor{k}} p_i^w\right) +
          p_{\ceil{k}}^w(k-\floor{k})
\]
\cite{beXX,gmXX}.

Consider the point-hyperplane duality
$\varphi:\mathbb{R}^d\rightarrow\mathbb{H}^d$ given by blah \cite{x} which
takes the points $p_1,\ldots,p_n$ onto hyperplanes $h_1,\ldots,h_n$,
respectively.  For a point $x$ and a hyperplane $h$, let $x\drop h$
denote the $d$th coordinate of the vertical projection of $x$ onto $h$
and let $h_i^x$ be the $i$th dual hyperplane encountered by a downward
vertical ray originating at $(x_1,\ldots,x_{d-1},\infty)$.

Under this duality $Z_k(S)$ dualizes to the set of all hyperplanes
that do not intersect either of two convex sets $R_A(S)$ and $R_B(S)$,
where
\[
   R_A(S) = \left\{x\in\mathbb{R}^d: x_d \le 
\left(\frac{1}{k}\sum_{i=1}^{\floor{k}} x\drop h_i^x\right) +
          (x\drop h_{\ceil{k}}^x)(k-\floor{k}) \right\}
\] 
and
\[
   R_B(S) = \left\{x\in\mathbb{R}^d: x_d \ge 
\left(\frac{1}{k}\sum_{i=n-\floor{k}+1}^{n} x\drop h_i^x\right) +
          (x\drop h_{n-\floor{k}}^x)(k-\floor{k}) \right\} \enspace .
\] 
The two sets $R_A(S)$ and $R_B(S)$ are convex, unbounded from above,
respectively, below, and piecewise linear.  Indeed, the linear pieces
of $R_A(S)$ (respectively $R_B(S)$) are in one to one correspondence
with the linear pieces of the $\ceil{k}$-level (respectively
$(n-\floor{k}+1)$-level) of $h_1,\ldots,h_n$.
The dual of $Z_k(S)$ is given by
\[
     \varphi(Z_k(S)) = \{ h\in\mathbb{H^d} : h\cap(R_A(S)\cup R_B(S)) = \emptyset \} \enspace .
\]

\section{The Decision Algorithm}

Next we consider the following decision problem:  Given a point set
$S$ and an integer $k$, is the origin contained in $Z_k(S)$?  One
approach to solving this problem is to compute the intersection of
$Z_k(S)$ with a vertical line through the origin and then check if
this intersection contains the origin. 

Under duality, the above strategy is equivalent to finding the lowest
point on $R_A$ and the highest point on $R_B$ and checking that each
of these points is above, respectively, below, the plane $x_d=0$.
In the remainder, we focus on determining the lowest point in
$R_A$.  Finding the highest point in $R_B$ is done in a symmetric
manner. 

\begin{thm}
Given a set $S$ of $n$ points in $\mathbb{R}^d$ the point $x\in
R_A(S)$ such that $x_d$ is minimum can be found in $O(n)$ expected
time.
\end{thm}

\begin{proof}
We apply \thmref{chan} to the following slightly more general problem:
We are given a set $H$ of hyperplanes, a special hyperplane $h$ and a
weight $t$.  The region we optimize over is given by 
\[
    R(H,h,t,k) = \left\{x\in\mathbb{R}^d: x_d \le 
t(x\drop h)+\left(\frac{1}{k}\sum_{i=1}^{\floor{k}} x\drop h_i^w\right) +
          (k-\floor{k})(x\drop h_{\ceil{k}}^w) \right\} \enspace .
\]

\end{proof}


\section{The Optimization Algorithm}

\end{document}

