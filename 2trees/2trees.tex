\documentclass[lotsofwhite,charterfonts]{patmorin}
\usepackage{amsthm,amsfonts,graphicx}
\input{pat}

\newcommand{\rep}[1]{^{\langle#1\rangle}}

\newcommand{\toomuchdetail}[1]{#1}
\newcommand{\degreesum}{Condition~(a)}
\newcommand{\maxdegree}{Condition~(b)}
\newcommand{\twotwos}{Condition~(c)}
\newcommand{\onebig}{Condition~(d)}
\newcommand{\fourds}{Condition~(e)}
\newcommand{\degree}{\mathrm{deg}}

\title{\MakeUppercase{Degree Sequences of 2-Trees}%
	\thanks{This research was partly funded by NSERC.}}

\author{
	Greg Aloupis \and
	Prosenjit Bose \and
	David Bremner \and
	Mirela Damian-Lordache \and
	Erik Demaine \and 
	Martin Demaine \and
	Dania El-Khechen \and
	Vida Dujmovi\'{c} \and
	Robin Flatland \and
	Francisco Gomez-Martin \and
	John Iacono \and
	Danny Kri\c{z}anc \and
	Stefan Langerman \and
	Erin Leigh McLeish \and
	Henk Meijer \and
	Pat Morin \and
	Suneeta Ramaswami \and
	David Rappaport \and
	Diane Souvaine \and
	Perouz Taslakian \and
	Godfried Toussaint \and
	Dmitri Tymoczko \and
	David Wood \and
	Stefanie Wuhrer \and
}

\date{}

\begin{document}
\maketitle
\begin{abstract}
A characterization of the degree sequences of 2-trees is
given.  This characterization yields a linear-time algorithm for
recognizing and realizing degree sequences of 2-trees.
\end{abstract}

\section{Introduction}

The \emph{degree sequence} of an undirected graph $G=(V,E)$ is the
sequence obtained by listing the degrees of the vertices of $G$ in
non-decreasing order.  If $D=\langle d_1,\ldots,d_n\rangle$ is the
degree sequence of $G$ then we say that $G$ is a \emph{realization} of
$D$ or that $G$ \emph{realizes} $D$. \comment{If a vertex $v\in V$ has degree
$d$ we say that $v$ is a degree-$d$ vertex.} 

In this paper we consider degree sequences of a particular class of
graphs.  \emph{2-trees} are defined inductively as follows:  The
complete graph $K_3$ on 3 vertices is a 2-tree and any 2-tree $T$ on
$n$ vertices can be obtained from some 2-tree $T'$ on $n-1$ vertices
by adding a new vertex $u$ adjacent to two vertices $v$ and $w$ that
are adjacent in $T'$.  We call this process \emph{attaching} the
vertex $u$ to the edge $\{v,w\}$.

Let $a\rep{b}$ denote the (sub)sequence $a,a,\ldots,a$ of length $b$.
We prove the following result:

\begin{thm}\thmlabel{main}
The following two statements are equivalent:
\begin{enumerate}
\item $D=\langle d_1,\ldots,d_n\rangle$ is a non-decreasing sequence of
      natural numbers such that
\begin{enumerate}
\item $\sum_{i=1}^n d_i = 4n-6$,
\item $\max\{d_i : 1\le i\le n\} \le n-1$,
\item $d_1=d_2=2$,
\item $D\not\in \{ 2\rep{p},4\rep{n-p-1}, 2p-2 : n > 3p-3 \}$, and 
\item $D\not\in \{\langle 2\rep{n-4},d\rep{4}\rangle : d\ge 5\}$.
\end{enumerate}
\item $D$ is the degree sequence of a 2-tree.  
\end{enumerate}
Furthermore, for each $D=\langle d_1,\ldots,d_n\rangle$ satisfying
Conditions~(a)--(e) and a given $d_i \ge 3$ there exists a 2-tree that
realizes $D$ in which a vertex of degree $d_i$ is adjacent to a vertex
of degree $2$.  
\end{thm}

We denote by $\mathcal{D}$ the set of all degree sequences satisfying
Conditions~(a)--(e) of \thmref{main} (hereafter referred to simply as
Conditions~(a)--(e)).  The remainder of this paper is organized as
follows:  In \secref{if} we show that the every sequence $D\in
\mathcal{D}$ is the degree sequence of a 2-tree.  In \secref{onlyif}
we show that the degree sequence of every 2-tree is in $\mathcal{D}$.
\secref{conclusions} summarizes and concludes with open problems.

\section{The Elements of $\mathcal{D}$ are the Degree Sequences of
	2-Trees}\seclabel{if}

In this section we prove that if $D\in \mathcal{D}$ then $D$ is the
degree sequence of a 2-tree.  Our proof is by induction on $n$, the
length of the sequence.  However, during the process of applying
induction we come across several different base cases.

In all of what follows, we use the following conventions.  The vertex
set of a graph $G$ is denoted by $V(G)$, and its edge set by $E(G)$.
The subgraph of $G$ induced by a set of vertices $S\subseteq V(G)$ is
denoted by $G[S]$. For a vertex $v\in V(G)$, $N(v)$ denotes the set
of neighbours of $v$ in $G$, that is, $\{w\,|\, \{v,w\}\in E(G)\}$.  A
vertex of degree $d=|N(v)|$ is called a degree-$d$ vertex.

We also make use of the following well known facts about 2-trees.
Consider a 2-tree $G$. Unless $G$ is isomorphic to $K_3$, no pair of
degree-2 vertices is adjacent in $G$. For each $v\in V(G)$, $G[N(v)]$
induces a connected tree in $G$, and $G[N(v)\cup \{v\}]$ is a 2-tree.
Finally, if $G'=G[S]$, $\S\subset V(G)$, is a 2-tree, then $G$ can be
obtained by starting with $G'$ and performing attach operations as
defined above. 

\subsection{The Base Cases}

In this section we give constructions for the base cases that occur in
our inductive proof.  Throughout this section we will give
constructions that realize 2-trees containing vertices of all degrees
$d_i\ge 3$ present in $D$ while ignoring the number of vertices of
degree 2 in our constructions.  \degreesum\ and the easily established
fact that all 2-trees on $n$ vertices have total degree $4n-6$ implies
that these constructions do indeed contain the correct number of
vertices of degree 2.

\begin{lem}\lemlabel{basecase-a}
The sequence $\langle 2,2,2\rangle$ is the degree sequences of a 2-tree.
\end{lem}

\begin{proof}
This follows immmediately from the definition of 2-trees.
\end{proof}


\begin{lem}\lemlabel{basecase-b}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{n-2},x,y\rangle:
x,y\ge 3\}$. 
Then there exists a 2-tree that realizes $D$ in which every vertex of
degree greater than $2$ is adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
From \degreesum\ we know that $2(n-2)+x+y=4n-6$ or, equivalently,
$x+y=2n-2$.  By \maxdegree\ this implies that $x=y=n-1$.  Thus,
we can create a 2-tree realizing $D$ by starting with a $K_3$ and
attaching $n-3$ vertices to one of its edges.
\end{proof}

\begin{lem}\lemlabel{basecase-c}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{n-3},x,y,z\rangle:
x,y,z\ge 3\}$. 
Then there exists a 2-tree that realizes $D$ in which every vertex of
degree greater than $2$ is adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
We create a 2-tree by starting with the graph $K_3$ (which, according
to \lemref{basecase-a}, is a
2-tree) and attaching the following numbers of vertices to its edges:
\[
    e_1=\frac{1}{2}(x+y-z-2) \enspace , \enspace
    e_2=\frac{1}{2}(x-y+z-2) \enspace , \enspace 
    e_3=\frac{1}{2}(-x+y+z-2) \enspace .
\]
It is straightforward to verify that the resulting 2-tree has three
vertices of degree $x$, $y$, and $z$, respectively, and that all other
vertices have degree 2.  All that remains to verify that is that
$e_1$, $e_2$ and $e_3$ are non-negative integers.  These number are
certainly integers because, by \degreesum, $x+y+z$ is even.  

Next we show that $e_1$ is non-negative.  Observe that, by \degreesum,
$2(n-3)+x+y+z = 4n-6$ or, equivalently, $x+y+z=2n$.  By \maxdegree,
this implies that $x+y \ge n+1$ and that $x+y-z \ge 2$.  Thus,
$x+y-z-2 \ge 0$ and $e_1$ is non-negative, as required.  
Exactly the same argument shows that $e_2$ and $e_3$ are also
non-negative.
\end{proof}

\begin{lem}\lemlabel{basecase-d}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{n-5},d,d,d,x,d+x-2 \rangle:
\mbox{$d,x\ge 3$}\}$.
Then there exists a 2-tree that realizes $D$ and in which, for every
$d\in D$ there exists a vertex of degree $d$ adjacent to a vertex of
degree 2.
\end{lem}

\begin{proof}
Begin with the 5 vertex fan depicted in \figref{basecase-d}.a that has
one vertex $v_1$ of degree 4, two vertices $v_2$ and $v_5$ of degree 2
and two vertices $v_2$ and $v_3$ of degree 3.  
There are two cases to
consider:

\begin{figure}
\begin{center}
\includegraphics[width=5in]{basecase-d}
\caption{The constructions of \lemref{basecase-d}}.
\figlabel{basecase-d}
\end{center}
\end{figure}

\noindent\textbf{Case 1:} $d\ge 4$.  In this case, attach 1 vertex
each to $\{v_2,v_3\}$ and $\{v_4,v_5\}$, attach $d-4$ vertices to
$\{v_3,v_4\}$, attach $x-3$ vertices to $\{v_1,v_2\}$ and attach
$\{d-3\}$ vertices to $\{v_1,v_5\}$ (\figref{basecase-d}.b).  Then
$\degree(v_1)=d+x-2$, $\degree(v_2)=x$,
$\degree(v_3)=\degree(v_4)=\degree(v_5)=d$, and all other vertices
have degree 2, as required.

\noindent\textbf{Case 2:} $d=3$.  In this case, attach $x-3$ vertices
to $\{v_1,v_2\}$.  Let one of these newly attached vertices be called
$v_6$ and attach another vertex to $\{v_1,v_6\}$
<<<<<<< .mine
(\figref{basecase-d-c}).  Then $\degree(v_1)=x+2=d+x-2$,
$\degree(v_2)=x$, $\degree(v_6)=\degree(v_3)=\degree(v_4)=3$, and 
=======
(\figref{basecase-d}.c).  Then $\degree(v_1)=x+2=d+x-2$,
$\degree(v_2)=x$, $\degree(v_6)=\degree(v_3)=\degree(v_4)=3$, and
>>>>>>> .r191
all other vertices have degree 2, as required. 
\end{proof}


\begin{lem}\lemlabel{basecase-e}
Suppose $D\in \mathcal{D}\cap \{\langle 2\rep{p},d\rep{n-p}\rangle:
\mbox{$d\ge 3$ and $n-p \ge 5$}\}$.
Then there exists a 2-tree that realizes $D$ and in which, for every
$x\in D$, $x\ge 3$, there exists a vertex
of degree $x$ adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
Let $q=n-p$. Having $q$ at least $5$ implies that $d\not=3$, otherwise
$D\not\in \mathcal{D}$, by Condition (a) of \thmref{main}. Suppose
$d=4$. In that case, Condition (a) of \thmref{main} implies that
$p=3$, giving rise to the sequence $D=\{\langle
2\rep{3},4\rep{n-3}\rangle$ with $n\geq 7$ (since $q\geq 5$). This
sequence is excluded from $\mathcal{D}$, by Condition (d) of
\thmref{main}. Therefore we may assume that $d\geq 5$.

Let $D$ denote a sequence satisfying the conditions of the lemma with
$q\geq 5$ and $d\geq 5$.  We prove the lemma by constructing a 2-tree
$G$ that realizes $D$.  Suppose we know the following claim to be
correct (which will be proved later).

\begin{clm} 
Let $D'\in \mathcal{D}\cap \{\langle 2\rep{p'},4,
d\rep{n-p'-1}\rangle:\mbox{$d\ge 5$ and $q'=n-p'-1 \ge 2$}\}$.  Then
there exists a 2-tree that realizes $D'$ in which the vertex of degree
4 is adjacent to a vertex of degree 2.  
\end{clm}

Consider a 2-tree $T'$ that realizes a sequence $D'$ from the above
claim. Let edge $vw$ be the edge of $T'$ such that $v$ is of degree 2
and $w$ is of degree 4 in $T'$. Attach $d-4>0$ vertices to edge $vw$
and call one of them $x$. Proceed by attaching one vertex, $y$, to
edge $vx$, followed by attaching one vertex to edge $vy$ and $d-3>0$
vertices to edge $yx$. (This construction is illustrated in
\figref{basecase-e-1}). The resulting graph $G$, is a 2-tree where the
degree of each vertex is either $d$ or $2$ and there is an edge
between a vertex of degree $2$ and a vertex of degree $d$ (consider
for example any one of $v$, $x$, or $y$). Since $v$, $w$, $x$ and $y$
have degree $d$ in $G$, $G$ has $q'+4$ vertices of degree $d$, and
realizes $D$ provided that $q\geq 6$.  

\begin{figure} \begin{center}
\includegraphics[width=2.2in]{basecase-e-1} \end{center} \caption{The
construction of \lemref{basecase-e}.} \figlabel{basecase-e-1}
\end{figure}

For sequences $D$ with $q=5$, we give explicit
realization for $D$. Start with a $2$-tree as in
\figref{basecase-e-2}.a. Attach
$\frac{d-4}{2}$ vertices to edge $v_1v_2$ and as many to edge $v_1v_5$. Note
that $d$ has to be even, since $q$ is odd, and thus $d\geq 6$. Attach
$\frac{d-6}{2}\geq 0$ vertices to edge $v_3v_4$, and $\frac{d}{2}>0$
vertices to each of the edges $v_2v_3$ and $v_4v_5$. The resulting $2$-tree
$G$ has $q=5$ vertices of degree $d$ and each vertex of degree $d$ is
adjacent to at least one vertex of degree $2$. Thus $G$ is a desired
realization of $D$.
\begin{figure}
\begin{center}\begin{tabular}{cc}
\includegraphics[width=2in]{basecase-e-2-1} &
\includegraphics[width=2in]{basecase-e-2-2} \\
(a) & (b) 
\end{tabular}\end{center}
\caption{More figures for \lemref{basecase-e}.}
\figlabel{basecase-e-2}
\end{figure}

To complete the proof we need to demonstrate that the above claim is
correct. Let $D'$ be the sequence from the claim with $q'\geq 2$
vertices of degree $d$. The proof is by induction on $q'$. The (even)
base case, $q'=2$, follows from \lemref{basecase-c}, with $x=4$, $y=d$
and $z=d$. For the (odd) base case, $q'=3$, we start with the 2-tree
from  \lemref{basecase-c} with $x=d-2>0$, $y=d$ and $z=d$ with an edge
between a vertex $v$ of degree $d-2$ and some vertex $w$ of degree 2
and simply attach two vertices to edge $\{v,w\}$ to obtain the
realization $T'$ for $D$ with an edge between a vertex of degree 2 and
a vertex of degree 4 in $T'$.

For the general case, that is, sequences $D'$ with $q'\geq 4$, we
start with a 2-tree $G^-$ that realizes the sequence with $q'-2$
vertices of degree $d$. Such a graph $G^-$ exists by the inductive
hypothesis and moreover there is an edge between a vertex $v$ of
degree 2 and the vertex $w$ of degree 4 in $G^-$. To obtain a
realization for $D'$ we attach $d-4>0$ vertices to edge $vw$, call one
of them $x$. Attach two more vertices to edge $vx$, as illustrated in
\figref{basecase-e-3}. In the resulting 2-tree $T'$, the degree of $v$
and $w$ is $d$, the degree of $x$ is $4$ and $x$ is adjacent to a
vertex of degree 2. Thus $T'$ has $g'$ vertices of degree $d$, one
vertex of degree 4 and an edge between a vertex of degree 4 and 
and a vertex of degree 2,
and is thus a desired realization of $D'$.
\begin{figure}
\begin{center} \includegraphics[width=2in]{basecase-e-3} \end{center}
\caption{Yet another figure for \lemref{basecase-e}.}
\figlabel{basecase-e-3} 
\end{figure} 
\end{proof}

\begin{lem}\lemlabel{basecase-f}
Suppose $D\in \mathcal{D}$ contains the value $n-1$. Let $x \geq 3$ be
an arbitrary value in $D$.  Then there exists a 2-tree that realizes
$D$ in which a vertex of degree $x$ is adjacent to a vertex of degree
$2$.
\end{lem}

<<<<<<< .mine
\begin{proof}
Alter the sequence $D$ by removing the value $n-1$ and by reducing
every remaining value by one. The degree sequence $D^{(1)} = \langle
d_1^{(1)},\ldots,d_{n_1}^{(1)}\rangle$ we obtain contains $n_1 = n-1$
values.  Since $D\in \mathcal{D}$,
$\sum_{i=1}^{n_1}d^({1})_i = 4n-6 - 2(n-1) = 2n_1 - 2$. It is
well-known that any degree sequence of positive integers of length $k$
with $\sum_{i=1}^{k} = 2k - 2$ is the degree sequence of a tree.
Hence, there exists a tree with degree sequence $D^{(1)}$.  It is also
known that adding a vertex adjacent to every vertex of a tree yields a
2-tree \cite{X}.
=======
\begin{proof} 
Alter the sequence $D$ by removing the value $n-1$ and by reducing
every remaining value by one. The new sequence $D^{(1)} = \langle
d_1^{(1)},\ldots,d_{n_1}^{(1)}\rangle$ we obtain contains $n_1 = n-1$
values.  Since $D\in \mathcal{D}$, $\sum_{i=1}^{n_1} d^{(1)}_i= 4n-6 -
2(n-1) = 2n_1-2$. It is well-known that any sequence of positive
integers of length $k$ whose sum is $2k-2$ is the degree sequence of a
tree. Hence, there exists a tree with degree sequence $D^{(1)}$. It is
also known that creating a new graph by adding a vertex adjacent to
every vertex in some tree yields a 2-tree \cite{?}.
>>>>>>> .r191

If $x = n-1$, we find a tree with degree sequence $D^{(1)}$. Adding a
vertex adjacent to every vertex of that tree yields a 2-tree that
realizes $D$. The last vertex we add is of degree $x = n-1$ and is
adjacent to every other vertex. Since there are at least two vertices
of degree $2$ in the resulting 2-tree, there exists a vertex of degree
$x$ adjacent to a vertex of degree $2$, as required.

<<<<<<< .mine
If $x \neq n-1$, then $D^{(1)}$ contains the value $x-1$.  We alter
the sequence $D^{(1)}$ by removing $d_1^{(1)}=1$ and by replacing the
value $x-1$ by $x-2$. The sequence $D^{(2)} = \langle
d_1^{(2)},\ldots,d_{n_2}^{(2)}\rangle$ contains $n_2 = n-2$ values.
Furthermore, $\sum_{i=1}^{n_2} = 2n_1 - 4 = 2n_2 - 2$. Hence, there
exists a tree with degree sequence $D^{(2)}$. We find this tree and
add a leaf adjacent to a vertex of degree $x-2$. Since $d_1^{(1)} =
1$, this results in a realization of $D^{(1)}$ as a tree, where a vertex of
degree $x-1$ is adjacent to a leaf of the tree. Adding a vertex
adjacent to every vertex of the tree realizing $D^{(1)}$ yields a
2-tree that realizes $D$. Since the last vertex we add increases the
degree of every vertex by one, there exists a vertex of degree $x$
adjacent to a vertex of degree $2$ in this 2-tree.  \end{proof}
=======
If $x \neq n-1$, we alter the sequence $D^{(1)}$ by removing
$d_1^{(1)}$ and by replacing the value $x-1$ by $x-2$. The sequence
$D^{(2)} = \langle d_1^{(2)},\ldots,d_{n_2}^{(2)}\rangle$ contains
$n_2 = n-2$ values. Furthermore, $\sum_{i=1}^{n_2} = 2n_1 - 4 = 2n_2 -
2$. Hence, there exists a tree with degree sequence $D^{(2)}$. We find
this tree and add a vertex adjacent to a vertex of degree $x-2$. Since
$d_1^{(1)} = 1$, this is a realization of $D^{(1)}$ as a tree, where a
vertex of degree $x-1$ is adjacent to a leaf of the tree. Adding a
vertex adjacent to every vertex of this tree yields a 2-tree that
realizes $D$. Since the last vertex we add increases the degree of
every vertex by one, there exists a vertex of degree $x$ adjacent to a
vertex of degree $2$ in this 2-tree, as required.
\end{proof}
>>>>>>> .r191

\begin{lem}\lemlabel{basecase-g}
Suppose $D\in \mathcal{D}\cap \{\langle
2\rep{p},4\rep{n-p-2},x,2p-x+2\rangle:x\ge 3\}$.  Then there exists a 2-tree
that realizes $D$ in which every vertex of degree greater than $2$ is
adjacent to a vertex of degree 2.
\end{lem}

\begin{proof}
We proceed by induction on the value $k=n-p-2$. 

\noindent {\em Base Case ($k=0$)}: When $k=0$, we have that $n=p+2$.
We need to consider two cases. Either $x<2p-x+2$ or $x=2p-x+2$. We
start with the former ($x<2p-x+2$).  In this case, we can conclude
that $x\leq p$. Since $p=n-2$, this means that $x\leq n-2$ This
implies that $2p-x+2\geq n$. But this is impossible by property (b)
(i.e.  no degree can be greater than $n-1$).

We now consider the latter case ($x=2p-x+2$). In this case, both
$x=n-1$ and $2p-x+2=n-1$. Therefore, $D=\langle
2\rep{n-2},n-1,n-1\rangle$.  We show how to construct a 2-tree having
degree sequence $D$.

Start with an edge with vertices labelled $a$ and $b$ and attach $n-2$
vertices of degree 2 adjacent to the edge $ab$. This is clearly a
2-tree. There are $n-2$ vertices of degree 2. Both vertex $a$ and $b$
have degree $n-1$, and are each adjacent to at least one vertex of
degree 2.

\noindent {\em Inductive Step:} Let sequence $D$ be $\langle
2\rep{p},4\rep{k+1},x,2p-x+2\rangle$. Again, we need to address the
case where $x<2p-x+2$ or $x=2p-x+2$. We start with the latter case
($x=2p-x+2$).  In this case, both $x=p+1$ and $2p-x+2=p+1$.
Therefore, the sequence $D$ is $\langle
2\rep{p},4\rep{k+1},p+1,p+1\rangle$.  Construct a new sequence $D' =
\langle 2\rep{p-1},4\rep{k},p-1,p+1\rangle$. By the inductive
hypothesis, there exists a 2-tree $G$ that realizes $D'$. 

We now show how to modify $G$ to construct a 2-tree realizing $D$.
Let $u$ be the vertex of degree $p-1$ in $G$.  By the inductive
hypothesis, $u$ is adjacent to a vertex $v$ of degree 2.  By adding 2
vertices of degree 2 to the edge $uv$, we realize the sequence $D$
since vertex $u$ has degree $p+1$, vertex $v$ has degree 4 and we
added 2 vertices of degree 2. Both vertex $u$ and $v$ are adjacent to
vertices of degree 2 and all other vertices of degree greater than 2
are adjacent to vertices of degree 2 by induction.

We now consider the former case where $x<2p-x+2$.  The sequence $D$ is
$\langle 2\rep{p},4\rep{k+1},x,2p-x+2\rangle$.  Let $p'=p-1$.
Construct a new sequence $D' = \langle
2\rep{p'},4\rep{k},x,2p'-x+2\rangle$. By the inductive hypothesis,
there exists a 2-tree $G$ that realizes $D'$. 

We now show how to modify $G$ to construct a 2-tree realizing $D$.
Let $u$ be the vertex of degree $2p'-x+2$ in $G$.  By the inductive
hypothesis, $u$ is adjacent to a vertex $v$ of degree 2.  By adding 2
vertices of degree 2 to the edge $uv$, we realize the sequence $D$
since vertex $u$ has degree $2p-x+2$, vertex $v$ has degree 4 and we
added 2 vertices of degree 2. Both vertex $u$ and $v$ are adjacent to
vertices of degree 2 and all other vertices of degree greater than 2
are adjacent to vertices of degree 2 by the inductive construction.
\end{proof}

\subsection{The Induction}

With the base cases out of the way, we are ready for an inductive
proof of the first half of \thmref{main}.

\begin{lem}\lemlabel{if}
If $D=\langle d_1,\ldots,d_n\rangle \in \mathcal{D}$ and $d_i\ge 3$
then there exists a 2-tree that realizes $D$ in which a vertex of
degree $d_i$ is adjacent to a vertex of degree 2.  
\end{lem}

\begin{proof}
We are given $D$ and a particular value $d_i$. If $D$ meets the
conditions of Lemmata~\ref{lem:basecase-a}, \ref{lem:basecase-b},
\ref{lem:basecase-c}, \ref{lem:basecase-d}, \ref{lem:basecase-e},
\ref{lem:basecase-f}, or
\ref{lem:basecase-g} then we are done.  Otherwise, select a value
$d_j$, $d_j\neq d_i$, $d_j\ge 3$.  We know such a value exists because
of \fourds\ and because
neither \lemref{basecase-a}, \lemref{basecase-b}, \lemref{basecase-c},
nor \lemref{basecase-e} is applicable to $D$.  The value $d_j$ is
selected as follows:  Let $a=\min\{d_k : d_k\ge 3\}$ and let $c=d_n$.
If $d_i=a$ or $a+c-2 \ge n$ then we select $d_j=d_n$ otherwise we
select $d_j=a$.  Without loss of generality, assume $d_i < d_j$
(otherwise reverse the roles of $d_i$ and $d_j$) and let $x=d_i$.
Create a new sequence 
\[  
   D'=\langle d_{x-2+1},\ldots,d_{i}-x+2,\ldots,d_{j}-x+2,\ldots,d_n \rangle
\] 
and, if necessary, reorder the elements of $D'$ into non-decreasing
order.  The proof of the following claim is left until later:

\begin{clm}\clmlabel{main}
$D'\in \mathcal{D}$.
\end{clm}

Now, apply the inductive hypothesis on the sequence $D'$ with the
special value $d_j-x+2$ to obtain a 2-tree $T'$ in which a vertex $v$
of degree $d_j-x+2$ is adjacent to a vertex $w$ of degree 2.  Attach
$x-2$ vertices to the edge $\{v,w\}$ to obtain a 2-tree that realizes
$D$ and in which vertices of degree $d_i$ and $d_j$ are each adjacent
to $x-2\ge 1$ vertices of degree $2$.  This completes the proof.
\end{proof}


\begin{proof}[Proof of \clmref{main}]

We must show that $D'$ satisfies Conditions~(a)-(e) of \thmref{main}.
We know that $D$ satisifies Conditions~(a)-(e) and that $D$ does not
satisfy the conditions of any of
Lemmata~\ref{lem:basecase-a}--\ref{lem:basecase-g}.  Let $p$ be the number
of times 2 appears in $D$ and recall that $a=\min\{d_k:d_k \ge 3\}$ and
$c=d_n=\max\{d_k:d_k\in D\}$.  We begin by considering \fourds\ and
\onebig\ since these can be shown independent of the choice of $d_j$.

\noindent\onebig:
If $D'\in\{\langle 2\rep{p'},4\rep{n'-p'-1},
2p'-2\rangle\}$ then 
$D\in\{\langle 2\rep{p},4\rep{n-p-2},x,2p-x+2\rangle:x\ge 3\}$ which
is not possible because then \lemref{basecase-g} would apply to $D$.

\noindent\fourds:
If $D'\in \{\langle 2\rep{n'-4},d,d,d,d\rangle : d\ge 5\}$ then
$D\in\{\langle 2\rep{n'+x-6},d,d,d,x,d+x-2\rangle : d,x\ge 3\}$ which
is not possible since then \lemref{basecase-e} would apply to $D$.


\comment{
If $n'< 2p'-1$ then
\[
      n' = n-x+2 < 2p'-1  
         \toomuchdetail{= 2(p-x+3) - 1}
         = 2p-2x + 5 \enspace , 
\]
so $n < 2p-x+3$ but this is not possible since then $D$ does not 
satisfy
\maxdegree.

On the other hand, if $n'>3p' - 3$ then
\[
      n' = n-x+2 > 3p' - 3 
         \toomuchdetail{= 3(p-x+3) - 3}
         = 3p - 3x + 6
\]
so $n > 3p - 2x + 4$.  So what?
}

Next we show that $D'$ satisfies Conditions~(a)-(c).  There are two
cases to consider, depending on the choice of $d_j$.

\noindent\textbf{Case 1:} $d_i=x=a$ and $a+c-2 \le n-1$.

\noindent\degreesum\ and \twotwos:  To show that these conditions hold for $D'$
it is sufficient to show that $p'=p-a+3 \ge 2$, i.e., that $p\ge a-1$.
Notice that, if $a=3$ then \twotwos\ on $D$ already implies $p\ge 2=
a-1$.  Thus, assume $a\ge 4$.  Then, from \degreesum\ we have
\[
      2p + a + 4(n-p-2) + d_j \le 4n-6 \enspace ,
\]
which simplifies to $p\ge (a+d_j)/2 -1 \ge a-1$, as required.

\noindent\maxdegree: To show that \maxdegree\ holds for $D'$, observe
that $\max\{d:d\in D'\}\le\max\{d:d\in D\}= c$ and the conditions of
Case~2 ensure that $c \le n-a+1= n'-1$.


\noindent\textbf{Case 2:} $d_j=d_n=c$ and $a+c-2\ge n$.  

First we dispense with the case $a=3$.  In this case the condition
$a+c-2\ge n$ implies $c\ge n-1$.  But this is not possible because
then \maxdegree\ implies that $c=n-1$ in which case
\lemref{basecase-f} applies to $D$.  Thus we will assume for the
remainder of the proof that $a\ge 4$.

\noindent\degreesum\ and \twotwos:  To show that these conditions hold
for $D'$, it suffices to show that $p'=p-x+3\ge 2$, i.e., that $p\ge
x-1$.  Since $a\ge 4$ and $D$ satisified
\degreesum, we have 
\[
             2p+4(n-p-2)+x+c \le 4n-6 \enspace ,
\]
which simplifies to $p\ge (x+c)/2-1\ge x-1$, as required.

\noindent\maxdegree:  Let $b=\max\{d:d\in D'\}$.  The sequence $D'$
has length $n'=n-x+2$ and we must show that $b\le n'-1$.  If
$b=d_n-x+2$ then the assumption that $D$ satisifies \maxdegree\
implies $b\le n'-1$.  Thus, assume $b\neq d_{n}-x+2$ so that the values
$x$, $b$ and $c$ each occur in $D$, i.e., $d_i=x$, $d_j=c$ and $d_k=b$
with $i$, $j$ and $k$ distinct.

Let $t=n-p-3$.  Then, from \degreesum\ on $D$ we have
\[
     2p + ta + x + b + c  \le 4n-6 \enspace , 
\]
which, since $n=p+t+3$, is equivalent to 
\[
     t(a-2) + x + b + c  \le 2n \enspace .
\]
Adding $1-x-n$ to both sides gives
\[
     t(a-2) + b + c - n + 1\le n - x + 1 = n' - 1\enspace .
\]
Since $a+c-n \ge 2$, $t\ge 0$ and $a\ge 3$ we have
\begin{eqnarray*}
     n'-1 & \ge & t(a-2) + b + c - n + 1 \\
          & \ge & t(a-3) + b + 3 \\
          & \ge & b+3 \ge b
\end{eqnarray*}
as required.

We have verified that in both cases $D'$ satisfies
Conditions~(a)--(e) of \thmref{main}, thus completing the proof of the
claim.
\end{proof}


\section{Degree Sequences of 2-Trees are in $\mathcal{D}$}\seclabel{onlyif}

\begin{lem}\lemlabel{onlyif-a}
Any sequence $D$ that does not satisfy Conditions~(a)-(c) of
\thmref{main} is not the degree sequence of any 2-tree.
\end{lem}

\begin{proof}
It is easy to verify that every 2-tree has $2n-3$ edges and hence
its degree sequence satisfies Condition~(a).
Every simple graph (and hence every 2-tree) satisfied Condition~(b).
Finally, Condition~(c) follows from the 
well-known fact that every two tree has at least 2 vertices of degree
2 \cite{X}.
\end{proof}

\begin{lem}\lemlabel{onlyif-b}
Any sequence $D\in\{\langle 2\rep{n-4},d,d,d,d\rangle : d\ge 5\}$ is not 
the degree sequence of any 2-tree.
\end{lem}

\begin{proof} 
Suppose, by way of contradiction, that $T$ is a 2-tree that realizes
<<<<<<< .mine
$D\in\{\langle 2\rep{n-4},d,d,d,d\rangle : d\ge 5\}$.  Then the degree
$d$ vertices in $T$ form the subgraph shown in \figref{onlyif-b}
(why?).  This graph has four vertices $v_1,\ldots,v_4$ and five edges
$e_1,\ldots,e_5$.  Let $x_i$ be the number of degree 2 vertices
attached to $e_i$, for $1\le i\le 5$ and let $d_i$ be the degree of
$v_i$.  Then we have
=======
$D\in\{\langle 2\rep{n-4},d,d,d,d\rangle : d\ge 5\}$.  Removing all
vertices of degree 2 from $T$ yields a 2-tree with 4 vertices. All
2-trees with four vertices are isomorphic to the graph illustrated
in 
\figref{onlyif-b}.  Thus, the degree $d$ vertices in $T$ form the
subgraph shown in \figref{onlyif-b}.  
This graph has four vertices $v_1,\ldots,v_4$ and five edges
$e_1,\ldots,e_5$. Let $d_i$, $1\le i\le 4$ be the degree of $v_i$ and 
let $x_i$ be
the number of degree 2 vertices attached to $e_i$, for $1\le i\le 5$.
Then we must have
>>>>>>> .r191
\[
<<<<<<< .mine
   \deg(v_1)+\deg(v_3) = 2d = x_1 + x_3 + x_2 + x_4 + 4
=======
   d_1+d_3 = (x_1 + x_2 + 2) + (x_3 + x_4 + 2)  <
   (x_1 + x_5 + x_3 + 3) + (x_2 + x_5 + x_4 + 3) = d_2 + d_4
>>>>>>> .r191
\]
<<<<<<< .mine
and 
\[
   \deg(v_2)+\deg(v_5) = 2d = x_2 + x_2 + x_3 + x_4 + x_5 + 5
\]
which is not possible since the $x_i$ are all non-negative.
=======
which is not possible since $d_1+d_3=d_2+d_4=2d$. 
\begin{figure}
\begin{center}
  \includegraphics[width=2in]{onlyif-b}
\end{center}
\caption{The degree $d$ subgraph in a realization of the sequence
$\langle 2\rep{n-4},d\rep{4}\rangle$.}
\figlabel{onlyif-b}
\end{figure}
>>>>>>> .r191
\end{proof}


\begin{lem}\lemlabel{onlyif-c}
Any sequence $D\in\{2\rep{p},4\rep{n-p-1}, 2p-2 : \mbox{$n < 2p-1$ or
$n > 3p-3$} \}$ is not the degree sequence of any 2-tree.
\end{lem}

\begin{proof}
Suppose, by way of contradiction, that $G$ is a 2-tree that realizes
$D\in\{2\rep{p},4\rep{n-p-1}, 2p-2 : \mbox{$n > 3p-3$} \}$.

We will make use of the following two well-known facts about 2-trees.
For each vertex in a 2-tree $H$, the graph induced in $H$ by the
neighbours of that vertex is a connected tree.  Furthermore, unless
the $H$ is isomorphic to the complete graph on three vertices, no pair
of degree-2 vertices is adjacent in $H$.

Let $h$ be a vertex of degree $2p-2$ in $G$. Note that $2p-2\geq 4$
and that $h$ is even. Let $V_4$ denote the set of degree-4 vertices in
$G$ (excluding $h$). Since $n>3p-3$, $|V_4|\geq 2p-3$. To derive the
desired contradiction we first prove the following observation.

(*) Each vertex of $V_4$ is adjacent to $h$ in $G$.

Suppose for the sake of contradiction that there is a vertex $x\in
V_4$ such that $xh$ is not an edge in $G$. $N(x)$ induces a connected
tree in $G$. Since $|N(x)|=4$ there are two trees to consider: a
3-star and a path. In the former case, $G'=G[N(x)\cup \{x\}]$ is
isomorphics to the graph depicted by in \figref{onlyif-bb}, where the two
degree-4 vertices are labeled by $x$ and $y$. By our assumption, $x$
is not adjacent to $h$ thus $G$ is not isomorphic to $G'$. However, it
is impossible to attache a vertex to any edge of $G'$ without
increasing the degree of either $x$ or $y$, which is a desired
contradiction for the case when $N(x)$ induces a 3-star in $G$.
\begin{figure}
\begin{center}\includegraphics[width=2in]{onlyif-c}\end{center}
\caption{The subgraph $G'$ in the proof of \lemref{onlyif-c}.}
\figlabel{onlyif-bb}
\end{figure}
\begin{figure}
\begin{center}\begin{tabular}{cccc}
\includegraphics[width=1.5in]{onlyif-c-1} &
\includegraphics[width=1.5in]{onlyif-c-2} &
\includegraphics[width=1.5in]{onlyif-c-3} &
\includegraphics[width=1.5in]{onlyif-c-4} \\
(a) & (b) & (c) & (d)
\end{tabular}\end{center}
\caption{The proof of \lemref{onlyif-c}.}
\figlabel{onlyif-c}
\end{figure}
Consider now the case that $N(x)$ induces a path in $G$, and let the
vertices of the path be denoted by $a,v,w,b$ as illustrated in
\figref{onlyif-c}.X. Then by our assumption, $v$ and $w$ are degree-4
vertices in $G$. Removing $v$, $w$ and $x$ from $G$ splits $G$ into
two or three connected components. Consider first the case that there
are three components, $G_1$, $G_2$ and $G_3$, as illustrated in
\figref{onlyif-c}.X. Vertices $v$, $w$ and $x$ have degree two
in$G[V(G_1)\cup \{x,v\}]$, $G[V(G_2)\cup \{x,w\}]$  and $G[V(G_3)\cup
\{v,w\}]$ and the corresponding degree-2 vertex pairs are adjacent in
their respective induced graphs. The only 2-tree that has an edge
between a pair of degree-2 vertices is the complete graph on three
verticdes, implying that $G$ is isomorphic to the graph in
\figref{onlyif-c}.X. That however contradicts our assumption that there is
vertex $h$ of degree at least $4$ in $G$ that is not adjacent to $x$.

Finally, consider the case that removing $v$, $w$ and $x$ from $G$
splits $G$ into two components, $G_1$ and $G_2$ as illustrated in
\figref{onlyif-c}.X, and consider, for instance, $G[V(G_1)\cup \{v,x\}]$. The
degree of $v$ in that graph is three, degree of $x$ is two and all the
remaining vertices in that graph have even degree (since all the
degrees in $D$ are even). That however is impossible since in any
graph the number of vertices of odd degree is even.

Armed with the above observation we are now ready to derive a
contradiction to our assumption that $G$ realizes $D$.

$G[N(h)]$ is a tree. Since the degree of $h$ is $2p-2$ and $|V_4|\geq
2p-3$, all but at most one neighbour of $h$ has degree four in $G$.
$G[N(h)]$ has at least two leaves, thus one of the leaves of $G[N(h)]$
has degree four in $G$. Let $v$ denote that leaf and let $w$ be its
neighbour in $G[N(h)]$. Since $2p-2>2$, $w$ is an internal vertex of
the tree $G[N(h)]$ and thus has at least degree $3$ in  $G[N(h)]$ and
exactly degree $4$ in $G$.

Since all vertices in $V\setminus \{h\cup N(h)\}$ have degree two in
$G$, $v$ is adjacent to two degree-2 vertices in $G$, $v_1$ and $v_2$.
The only way for $v$ to have degree $4$ in $G$ is by attaching $v_1$
and $v_2$ to its incident edges. Neither $v_1$ nor $v_2$ can be
attached to $vh$ as it would increase the degree of $h$ in $G$. Both
cannot be attached to $vw$ as that would increase the degree of $w$ in
$G$ to at least $5$. 
\comment{Suppose, by way of contradiction, that $T$ is a 2-tree that realizes
$D\in\{2\rep{p},4\rep{n-p-1}, 2p-2 : n > 3p-3 \}$.  We claim the
following two properties hold:
\begin{enumerate}
\item Every degree 4 vertex in $T$ is adjacent to the degree $2p-2$
vertex and
\item At least two vertices of degree 2 are adjacent to the degree
$2p-2$ vertex.
\end{enumerate}
(Vida has a proof forthcoming.) But these two conditions imply that
\[
                       2p-2 \ge n-p-1 + 2 \enspace ,
\]
i.e., $n\le 3p-3$, a contradiction.
\comment{
Consider the subgraph $T'$ of $T$ induced by the degree 4 vertices.
It has the following properties:
\begin{enumerate}
\item Every vertex in $T'$ is adjacent to the vertex of degree $2p-2$.
\item $T'$ is a tree
\end{enumerate}

Let $n_1$, $n_2$ and $n_3$ be the number of leaves, respectively, degree 2
vertices and degree 3 vertices, in $T'$.  Then because $T'$ is a
binary tree we have 
\begin{equation}
   n_1=n_3+2 \enspace . \eqlabel{leaves} 
\end{equation}
Every degree 1, respectively, degree 2, vertex in $T'$ is adjacent to
2, respectively, 1, degree 2 vertex in $T$ and at least one degree 2
vertex is adjacent to the degree $h$ vertex so
\begin{equation}
   2n_1 + n_2 \le 2p-1  \enspace . \eqlabel{charging}
\end{equation} 
Subtracting \eqref{leaves} from \eqref{charging} gives
\[
    n_1 + n_2 + n_3 \le 2p-3
\]
and using the identity 
\begin{equation}
     n_1+n_2+n_3 = n-p-1 \eqlabel{size}
\end{equation}
gives
\[
     n \le 3p-2 \enspace 
\]
which contradicts the assumption that $T$ is a realization of $D$.}}
\end{proof}

\begin{lem}\lemlabel{onlyif}
Any sequence $D\not\in \mathcal{D}$ is the not the degree sequence of
any 2-tree.
\end{lem}

\begin{proof}
This follows immediately from \lemref{onlyif-a}, \lemref{onlyif-b} and
\lemref{onlyif-c}.
\end{proof}

\section{Conclusions}

Together, \lemref{if} and \lemref{onlyif} prove \thmref{main}.
\thmref{main} provides an easy $O(n)$ time algorithm for recognizing
the degree sequences of 2-trees simply by verifying the
Conditions~(a)--(e).  When a sequence is realizable as a 2-tree $T$,
the proof of \lemref{if} leads to a linear-time algorithm for
constructing $T$ that we sketch here.

First, observe that we can represent the sequence $D$ using
\emph{run-length encoding}.  That is, we use a list of pairs
$(\Delta_i,r_i):1\le i\le k$ which denotes that the element $\Delta_i$
occurs $r_i$ times in the sequence and keep this list sorted by the
$\Delta_i$ values. (Here $k$ is the number of distinct values in $D$.)
The inductive proof in \lemref{if} results in algorithm that runs in
$O(n)$ steps.  Each step does three things:
\begin{enumerate}
\item checking if the sequence $D$ conforms to any of the base cases
in Lemmata~\ref{lem:basecase-a}--\ref{lem:basecase-f},
\item checking the values of $a=\min\{d_i: d_i\ge 3\}$ and
$c=\max\{d_i:d_i\in D\}$, and 
\item removing leading 2's and reducing the values of 
$d_i$ and $d_j$ before recursing.
\end{enumerate}

Note that all the base cases in
Lemmata~\ref{lem:basecase-a}--\ref{lem:basecase-f} have run-length
encodings of constant size, thus they can be checked in $O(1)$ time.
Furthermore, all the constructions in the base cases are easily
achieved in $O(n)$ time.  Checking the values of $a$ and $c$ is easily
done in $O(1)$ time, since these are the values $\Delta_2$ and
$\Delta_k$.  Removing leading 2's can be done in $O(1)$ time by
reducing the value of $r_1$.  Reducing the values of $d_i$ and $d_j$
depends on how much they are reduced and these values forward
in the run-length encoding.  However, this can easily be implemented
in $O(d_i)$ time and causes the sum of the sequence to decrease by
$2d_i-4$.  Since the initial sum of the sequence is $4n-6$ this means
that the total time spent on reducing values during all steps is
$O(n)$.  Thus, the entire algorithm runs in $O(n)$ time.

An obvious direction for future work is to find a characterization of
the degree sequences of $k$-trees for any $k\ge 3$.  Another related
problem is to find a characterization of the degree sequences of
maximal outerplanar graphs (a subclass of 2-trees).

\section{Acknowledgements}

This research was initiated at the The 21st Bellairs Winter Workshop
on Computational Geometry, January 27--February 3, 2006.  The authors
are grateful to Godfried~Toussaint for organizing the workshop and to
the other workshop participants, namely
---,
---,
---, and
---,
for providing a stimulating working environment.


\bibliographystyle{plain}
\bibliography{paper}
\end{document}

