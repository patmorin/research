\documentclass{patmorin}
\usepackage{amsthm,amsmath,graphicx,stmaryrd,amsopn}
\usepackage{pat}

\newcommand{\eps}{\varepsilon}

\title{\MakeUppercase{A Crossing Number Inequality for 3D Grid Drawings}}
\author{Vida Dujmovi\'c,\thanks{Department of Mathematics and Statistics
and Department of Systems and Computer Engineering, Carleton University}\, Pat Morin,\thanks{School of Computer Science, Carleton University}\, and Howard Wolowitz}


\DeclareMathOperator{\x}{x}
\DeclareMathOperator{\y}{y}
\DeclareMathOperator{\z}{z}
\DeclareMathOperator{\crs}{cr}
\DeclareMathOperator{\len}{len}
\DeclareMathOperator{\skp}{skip}

\begin{document}
\maketitle

\begin{abstract}
   We study crossing number inequalities for 3d-grid drawings.
\end{abstract}

\section{Introduction}

The \emph{$X\times Y\times Z$ grid} is the point set $\{(x,y,z):
x\in\{1,\ldots,X\},\, y\in\{1,\ldots,Y\},\, z\in\{1,\ldots,Z\}\}$.
The volume of the $X\times Y\times Z$ grid is $XYZ$. A \emph{(proper)
drawing}, $\varphi:V(G)\rightarrow R$, of a graph, $G$, on a grid, $R$,
is a one-to-one mapping such that, for every edge $uw\in E(G)$ and every
vertex $x\in V(G)$, the open line segment with endpoints $\varphi(u)$
and $\varphi(w)$ does not contain $x$.

Define $\crs(G,n)$ to be the minimum number of edge crossings in
a drawing of $G$ on a grid whose volume is at most $n$.  Define
$g(n,m)=\min\{\crs(G,n):\text{$G$ is a graph with $m$ edges}\}$.
In this paper, we show that there exists constant $c_1,c_2,c_3>0$ such that, 
for all $m> c_3n$
\[
   c_1(m^2/n)\log\log(m/n) \le g(n,m) \le c_2(m^2/n)\log(m/n) \enspace .
\]
The proof of the lower bound is given in \secref{lower-bound} and the
upper bound is given in \secref{upper-bound}.



\section{The Lower Bound}
\seclabel{lower-bound}

\begin{thm}
  $g(n,m) \in \Omega((m^2/n)\log\log (m/n))$.
\end{thm}

\begin{proof}
Let $G$ be a drawing of a graph on the $X\times Y\times Z$ grid, with
$n=XYZ$, that has $m$ edges and for which $\crs(G,n)=g(n,m)$. ($G$
has the minimum number of crossings over all drawings of graphs with
$m$ edges.)  We may assume, without loss of generality, that no edge of
$G$ contains any point of the $X\times Y\times Z$ grid in its interior;
such an edge could be replaced with a shorter edge without introducing
any additional crossings.

For a prime number, $p$, define the $X\times Y\times Z$ \emph{$p$-grid}
as the set of points
\[
  \{(x/p,y/p,z/p): x\in\{1,\ldots,pX\},\, y\in\{1,\ldots,pY\},\,
  z\in\{1,\ldots,pZ\}\} \enspace .
\]
Note that the number of points in the $X\times Y\times Z$ $p$-grid is
no more than $np^3$.  Note, furthermore, that each edge $uw$ of $G$
contains the $p$-grid points
\[
    P_{uw}^p = \{ (i/p)u + ((p-i)/p)w : i\in\{1,\ldots,p-1\} \} \enspace .
\]
Finally, observe that $P_{uw}^p$ does not contain any $q$-grid points
for any prime $q\neq p$.  (This follows from the assumption that no edge
contains a grid point in its interior, so $\gcd(\x(u)-\x(w), \y(u)-\y(w),
\z(u)-\z(w))=1$.  In particular, at least one of $\x(u)-\x(w)$,
$\y(u)-\y(w)$, $\z(u)-\z(w)$ does not have $p$ as a divisor.)

Therefore, there are at least $(p-1)m$ incidences between edges of $G$
and points of the $p$-grid that are not points of any $q$-grid for $q\neq p$.
Any point of the $p$ grid incident
on $k$ edges contributes $\binom{k}{2}$ to $\crs(G)$.  Therefore, the
total contribution of the $p$-grid to $\crs(G)$ is at least
\[
    np^3\binom{m(p-1)/np^3}{2} \ge cm^2/np
\]
for $c<blah$ and $m(p-1)/np^3 \ge 2$.  This latter condition can be rewritten
as $p \le c'(m/n)^{1/2}$ for a sufficiently small $c'>0$.
Finally, we finish by summing over primes $p$ smaller than $c'p^{1/2}$:
\[
   \crs(G) \ge \sum_{p} cm^2/np = (cm^2/n) \sum_{p} 1/p = ((cm^2/n)(\ln\ln(m/n)-O(1))
\]
where the last inequality is Euler's result on the sums of reciprocals
of primes. (This sum is also known as a harmonic series of primes).
\end{proof}

%\To see this, notice that 
%\begin{thm}
%  $g(n,m,q)=\Omega(m^3/q^2)$ 
%\end{thm}
%
%\begin{proof}
%The weaker inequality ,
%\begin{equation}
%  g(n,m,q)\ge m-7q \enspace ,\eqlabel{weak}
%\end{equation}  
%is easily shown by induction
%on $m$, using the result of Cyzowicz \etal\ \cite{X} which states that
%$g(n,m,q) > 0$ if $m> 7q$ (any drawing with more than $7q$ edges contains
%at least one crossing).
%
%Next we show that, using induction on $n$, that 
%\[
%   g(n,m,q) \ge Cm^3/q^2
%\]
%for any $m\ge 8q$.  Note that the case 
%
%
%First, note that the result is easily established
%using \eqref{weak} for any $m$ such that $8q\le m\le 9q$ for $C\le 1/81$.
%
%Next, consider the case $m> 9q$.  Consider some drawing, $\varphi$, of
%$G$ with $\crs(G,q)$ crossings.  Count the pairs $(c,w)$ where $c$ is
%a crossing and $w$ is a vertex not incident to either of the two edges
%involved in $c$.  Each crossing, $c$, appears in $n-4$ such pairs so
%the total number of those pairs is $(n-4)\crs(G,q)$.  On the other hand,
%each vertex, $w$, occurs in at least $\crs(G\setminus w,q)$ such pairs.
%Therefore,
%\[
%   (n-4)\crs(G,q) \ge \sum_{w\in V(G)} \crs(G\setminus w, q) \enspace .
%\]
%The number, $m_w$, of edges in $G\setminus w$ is at least $m-(n-1)
%\ge m-q\ge 8q$ so, by induction, $\crs(G\setminus w,q)\ge Cm_w^3/q^2$.
%Putting everything together, we have
%\begin{align*}
%  (n-4)\crs(G,q) 
%    & \ge  \sum_{w\in V(G)} \crs(G\setminus w, q) \\
%    & \ge  C\sum_{w\in V(G)} m_w^3/q^2  \\
%    & \ge  Cn((n-2)m/n)^3/q^2 & \left(\mbox{since $\sum_{w\in V(G)} m_w^3\ge n((n-2)m/n)^2$}\right) \\
%    & =  (Cm^3/q^2)\cdot(n(n-2)^3/n^3)  \\
%\end{align*}
%Damn! The second factor in the last line is less than 1 and I don't see any
%way to fix it.
%\end{proof}
%

\section{The Upper Bound}
\seclabel{upper-bound}

In this section, we prove the following result:

\begin{thm}\thmlabel{upper-bound}
  $g(n,m) \in O((m^2/n)\log (m/n))$.
\end{thm}

The proof of \thmref{upper-bound} follows easily from the following lemma:
\begin{lem}\lemlabel{2-layer}
  There exists a drawing of the complete bipartite graph $K_{k^2,k^2}$
  on the $k\times k\times 2$ grid with $O(k^6\log k)$ crossings.
\end{lem}

Before proving the lemma, we first show how it implies
\thmref{upper-bound}: For simplicity, in what follows, assume $\sqrt{n}$,
$\sqrt{m/n}$, and $\sqrt{m}/n$ are each integers.  Apply \lemref{2-layer},
with $k=\sqrt{m/n}$ and tile the $\sqrt{n}\times\sqrt{n}\times 2$ grid
with $n/k^2$ copies of this drawing. The resulting geometric graph has
$2n$ vertices, $nk^4/k^2=m$ edges and
\[ O((n/k^2)k^6\log k) = O(nk^4\log k) = O((m^2/n)\log(m/n))
\] 
crossings, as required by \thmref{upper-bound}.

\begin{proof}[Proof of \lemref{2-layer}]
The drawing of $K_{k^2,k^2}$ is the obvious one; each point with
$z$-coordinate 1 is connected by an edge to every point with
$z$-coordinate 2.  

We start by considering some edge $uw$ with $\z(u)=1$ and counting
the number of edges that intersect $uw$.  Let $\pi_1,\ldots,\pi_k$ be
the planes that contain $uw$ and at least one additional grid point.
Observe that each plane $\pi_j$ contains, and is uniquely determined by,
a line in the plane $z=1$ that passes through some point, $p_j$ of the
integer lattice $\N^2$ and such that $up_j$ does not contain any other
lattice points, i.e., $\gcd(\x(u)-\x(p_j),\y(u)-\y(p_j))=1$ (see \figref{planes}).
\begin{figure}
  \centering{\includegraphics{planes}}
  \caption{A plane $\pi_j$, defined by a point $p_j$, with $\skp(\pi_j)=2$.}
  \figlabel{planes}
\end{figure}
Define the \emph{skip} of $\pi_j$ as
\[
   \skp(\pi_j)=\max\{|\x(u)|-\x(p_j)|,|\y(u)-\y(p_j)|\} \enspace .
\]
Observe that, if $\skp(\pi_j)=r$, then $\pi_j$ contains at most $2k/r$
points other than $u$ and $w$ and therefore contains at most $(k/r)^2$
edges that cross $uw$.  Furthermore, the number of planes $\pi_j$ such
that $\skp(\pi_j)=r$ is at most $4r+1$.  Therefore, the total number
of edges that cross $uw$ is at most
\[
   \sum_{r=1}^k (4r+1)(k/r)^2 \le 4k^2\ln k + O(k) \enspace .
\]
Since this is true for each of the $k^4$ edges, $uw$, we conclude that
the total number of crossings in this drawing of $K_{k^2,k^2}$ is at
most $4k^6\ln k+O(k^3)\in O(k^6\log k)$, as required.
\end{proof}

\section{Summary}
\seclabel{summary}


Open problem: our lower-bound argument fails for $d\ge 4$.

\section*{Acknowledgement}

The work of Pat Morin was partly funded by NSERC and CFI.

\bibliographystyle{plain}
\bibliography{template}


\end{document}


