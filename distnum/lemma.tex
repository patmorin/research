\documentclass{article}
\usepackage{amsthm}

\input{pat.tex}
\newcommand{\cn}{\mathsf{cr}}
\newcommand{\dn}{\mathsf{dn}}

\begin{document}

\begin{lem}[Crossing Lemma]
Let $G$ be a simple graph.  Then 
\[  \cn (G) \ge \frac{1}{64}\frac{|E(G)|^3}{|V(G)|^2}
\]
or, stated another way 
\[
  |E(G)| \le 4\left(\cn(G)|V(G)|^2\right)^{1/3} \enspace .
\]
\end{lem}

\begin{thm}
Any graph $G$ with distance number $d\le n$ has at most
$O(d^{5/3}n^{4/3})$ edges.
\end{thm}

\begin{proof} 
Let $r_1,\ldots,r_d$ be the lengths of the edges used in some
embedding of $G$ that achieves $d$ edge lengths and let $S$ be the set
of points used for the vertices in that embedding. 
Consider the non-simple multigraph graph $H$ with $V(H)=S$ that is
obtained by drawing circles of radii $r_1,\ldots,r_d$ centered at each
point of $S$ and adding the edge $uv$ to $E(H)$ if $u$ and $v$ occur
consecutively on one of these circles.

We observe that the circles used to define $H$ give a drawing of $H$
with at most $(dn)^2$ crossings, so $\cn(H)\le (dn)^2$. Furthermore,
the number of edges in $E(H)$ is at least twice the number of edges in
$G$, i.e., $E(H) \ge 2E(G)$.  Now, define the graph $H'$ by removing
self-loops and duplicate edges from $H$.  Since $E(H)$ contains at
most $dn$ self-loops and each edge occurs with multiplicity at most
$2d$ in $E(H)$ we have $E(H') \ge E(H)/d - n$.  Putting all this
together we get
\begin{eqnarray*}
   2E(G) &\le& E(H) \\
         &\le& d(E(H')+n) \\
         &\le& d\left(4\left(\cn(H') n^2\right)^{1/3}+n\right) \\
         &\le& d\left(4\left(\cn(H) n^2\right)^{1/3}+n\right) \\
         &\le& 4d(d^2n^4)^{1/3})+dn \\
         &\le& 4d^{5/3}n^{4/3}+dn \\
         & = & O(d^{5/3}n^{4/3})
\end{eqnarray*}
for $d\le n$, as required.
\end{proof}
For $d\le n^{1/13}$ this beats the bound in Lemma 5.
\end{document}
